Manual Inject 
$ kubectl label namespace <test> istio-injection=enabled 
$ kubectl get namespace -L istio-injection=enabled 


EKS
curl http://localhost:61679/v1/enis | python -m json.tool

Kubectl install
---------------
curl -o kubectl https://amazon-eks.s3.us-west-2.amazonaws.com/1.21.2/2021-07-05/bin/linux/amd64/kubectl
chmod +x kubectl 
mv kubectl /usr/bin/
kubectl version


.bashrc
export KUBECONFIG=$KUBECONFIG:~/.kube/kubeconfig
alias k='kubectl'



mkdir -p .kube && touch .kube/kubeconfig

kubeconfig
apiVersion: v1
clusters:
- cluster:
    server: https://2F7345CF9F048C72D5255AA2AC1183B0.gr7.us-east-2.eks.amazonaws.com
    certificate-authority-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM1ekNDQWMrZ0F3SUJBZ0lCQURBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwcmRXSmwKY201bGRHVnpNQjRYRFRJeE1UQXlOakEzTVRneU0xb1hEVE14TVRBeU5EQTNNVGd5TTFvd0ZURVRNQkVHQTFVRQpBeE1LYTNWaVpYSnVaWFJsY3pDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBTHpPCmpjSW1VZzJpbUJUTEhLb1FubXB4amdSUnlUNDZMZGkxbEJ4NmRRVFhNQjY4dFp5UkVwMnU1ZDFtUFAzVjlMaEEKR2xiSVpHTnV5dXJ3UkZtdFFveERuNlo5OFprTjNMRTR4UHlBK2VxMGtDM3ZTUURpNUFINUdKVWo4aHJnczlSeApxdVltVDdQaVo3QkJvVjVsZkFmemlvQVd6VTNkZjA2RXlHbDJkaXV6N2NaYW1XT0FtVHBoa21TLzg3VVBuekVXCldYWFhSZDdoSThxcGZ2b2I0cXlXZU1BTlorZVBWdk1rY3pvYWdKZUJOWDc4YmV2KzFqTlNEWjJGdWErbW5tdzEKMlltaXd1QVdjTGxnZGxGUmF6VytSL2Z1OWk2Yi9ja2tUWDhjdFljZ1pXNUhSdEIxR21DTTIrbnJiV1libWFFdwphRUlDV2tWUkVVd0VKV3BMR2RNQ0F3RUFBYU5DTUVBd0RnWURWUjBQQVFIL0JBUURBZ0trTUE4R0ExVWRFd0VCCi93UUZNQU1CQWY4d0hRWURWUjBPQkJZRUZQTmZ4YmFPYjhmbUFIKzFHdjh2eURpZUVHWlZNQTBHQ1NxR1NJYjMKRFFFQkN3VUFBNElCQVFDYUhjSnlsMzRBb1puRnFXemFlcUxXVnBGTTZQelNNTE9kcktvVjA4ZS9QcEdrNmFZVgptVFdHbU13MnlBLzNyOFFaUVJ4ckNxbWsxWDMvYnNmM3RTZWx2RllSbTNBaGhjeFRlcnpRYjhZQy82cjVIdnliCmZuYTB5ZmcxRnVMWjBzek9Jb2tjbnpnZ0VTWHlHL0lmbkxHR25WZDRrTXVJbEJwd0JwOXUwTlBiL2htbTlsNGwKWUlCWnNaN1Y5Tm9GZ1hZc2JVNmw5RTVFVi9TcEpPNytkZmZZNWxQYmlDaTlNMWkzaG95NDgremVxMzBvYWtYSwoxZWFHb0JpRDJqbzQ0N3crcE5PeGZseU43Z21HSC8wYWNlU25ZeWFjM1l5VTJUdWJmNkdQNmhLWGI4d1Y2dElqCm1SL253WDlxeFUvRHlVbG8wUU84MWhtZ1JkemdpV3pTMHMrRAotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
  name: kubernetes
contexts:
- context:
    cluster: kubernetes
    user: aws
  name: aws
current-context: aws
kind: Config
preferences: {}
users:
- name: aws
  user:
    exec:
      apiVersion: client.authentication.k8s.io/v1alpha1
      command: aws-iam-authenticator
      args:
        - "token"
        - "-i"
        - "gr-eks-cluster-EAST"
        # - "-r"
        # - "<role-arn>"
      # env:
        # - name: AWS_PROFILE
        #   value: "<aws-profile>"
        
kubectl set env daemonset aws-node -n kube-system AWS_VPC_K8S_CNI_CUSTOM_NETWORK_CFG=true

ENI-file

apiVersion: crd.k8s.amazonaws.com/v1alpha1
kind: ENIConfig
metadata: 
  name: us-west-2
spec: 
  securityGroups: 
    - sg-0aea6f2a6ddd10ca2
  subnet: subnet-0ef820a7a943a1e55
  
  
  Cluster security group 
  sg-0e9ec14e273b02680
  
  kubectl annotate node ip-10-0-0-61.us-east-2.compute.internal  k8s.amazonaws.com/eniConfig=subnet-a


WEST 

VPC -
IG - igw-06bc6d0c2db71ae3f
g-eks-west, vpc-046c27c10ae43119e, 
Subnets
1. g-west-1`, subnet-093d1056871f3b50f, us-west-2a, 20.0.3.0/24 
2. g-west-2 , subnet-00a57dd5dfbc021aa, us-west-2b, 20.0.4.0/24

  
  




